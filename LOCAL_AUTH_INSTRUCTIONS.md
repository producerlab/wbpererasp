# Инструкция по локальной авторизации

## Зачем это нужно?

WB блокирует SMS с Railway серверов (детектирует автоматизацию). Поэтому авторизация выполняется **локально на вашем компьютере** - SMS придет, cookies сохранятся в Railway БД.

## Шаги

### 1. Убедитесь что Playwright установлен

```bash
# Установка браузера Chromium для Playwright
playwright install chromium
```

### 2. Добавьте DATABASE_URL в .env

Скопируйте `DATABASE_URL` из Railway в файл `.env`:

```bash
# В .env файле добавьте:
DATABASE_URL=postgresql://postgres:password@host:5432/railway
```

Чтобы получить DATABASE_URL:
1. Зайдите в Railway → ваш проект
2. Откройте вкладку **Variables**
3. Скопируйте значение `DATABASE_URL`
4. Вставьте в `.env` файл

### 3. Запустите скрипт

```bash
python local_auth.py
```

### 4. Следуйте инструкциям

Скрипт спросит:
- Ваш Telegram ID (например: `98314773`)
- Номер телефона (например: `+79991234567`)

### 5. Введите SMS код

- Откроется окно браузера Chrome
- Скрипт автоматически отправит запрос SMS
- **SMS придет на ваш телефон**
- Введите код в консоль (не в браузер!)

### 6. Готово!

Скрипт автоматически:
- Захватит cookies
- Распарсит всех поставщиков
- Сохранит в Railway БД

### 7. Проверка

Запустите `/start` в Telegram боте:
- **Должна сразу появиться кнопка "Открыть Перераспределение"**
- **БЕЗ запроса SMS!**

## Важно

- **НЕ закрывайте браузер** пока скрипт работает
- Если что-то пошло не так - просто запустите скрипт заново
- Авторизация сохраняется навсегда (пока не нажмете "Войти заново" в боте)

## Устранение проблем

**Браузер не открывается:**
```bash
playwright install chromium
```

**DATABASE_URL не найден:**
- Проверьте файл `.env`
- Убедитесь что скопировали полный URL из Railway

**SMS не приходит:**
- Подождите 1-2 минуты
- Проверьте номер телефона
- Попробуйте другой номер
