"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Å–∫–ª–∞–¥–æ–≤ WB –∏ –∏—Ö ID.
"""
import sqlite3
import sys
from pathlib import Path

# –ü—É—Ç—å –∫ –ë–î –Ω–∞–ø—Ä—è–º—É—é
DATABASE_PATH = "bot_data.db"


def get_warehouses_from_db():
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–∫–ª–∞–¥–æ–≤ –∏–∑ –ë–î (–µ—Å–ª–∏ –æ–Ω–∏ —Ç–∞–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã)"""
    conn = sqlite3.connect(DATABASE_PATH)
    cursor = conn.cursor()

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å—Ç—å –ª–∏ —Ç–∞–±–ª–∏—Ü–∞ warehouses
    cursor.execute("""
        SELECT name FROM sqlite_master
        WHERE type='table' AND name='warehouses'
    """)

    if cursor.fetchone():
        cursor.execute("SELECT * FROM warehouses LIMIT 10")
        rows = cursor.fetchall()
        if rows:
            print("–°–∫–ª–∞–¥—ã –∏–∑ –ë–î:")
            print("-" * 80)
            for row in rows:
                print(row)
            print("-" * 80)
    else:
        print("–¢–∞–±–ª–∏—Ü–∞ warehouses –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –ë–î")

    conn.close()


def get_common_warehouse_ids():
    """–í—ã–≤–µ—Å—Ç–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ ID —Å–∫–ª–∞–¥–æ–≤"""
    print("\n" + "=" * 80)
    print("–ß–ê–°–¢–û –ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï –°–ö–õ–ê–î–´ WILDBERRIES")
    print("=" * 80)

    common_warehouses = {
        "–ö–æ–ª–µ–¥–∏–Ω–æ": 507,
        "–ü–æ–¥–æ–ª—å—Å–∫": 117501,
        "–≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å": 1733,
        "–ö–∞–∑–∞–Ω—å": 120762,
        "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä": 130744,
        "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": 121709,
        "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥": 117986,
        "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": 686,
        "–¢—é–º–µ–Ω—å": 1193,
        "–ë–µ–ª–∞—è –î–∞—á–∞ (–ö–æ—Ç–æ–≤—Å–∫)": 658434,
        # –†—è–∑–∞–Ω—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ ID –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–∫–ª–∞–¥–∞
    }

    print("\n–û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫–ª–∞–¥—ã:")
    for name, wh_id in common_warehouses.items():
        print(f"  {name}: {wh_id}")

    print("\n" + "=" * 80)
    print("‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: ID —Å–∫–ª–∞–¥–æ–≤ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è!")
    print("–î–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:")
    print("  1. –õ–ö Wildberries ‚Üí –ü–µ—Ä–µ—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ‚Üí –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –≤—ã–ø–∞–¥–∞—é—â–µ–º —Å–ø–∏—Å–∫–µ")
    print("  2. WB API /api/v3/offices")
    print("=" * 80)


def search_warehouse(name: str):
    """–ü–æ–∏—Å–∫ —Å–∫–ª–∞–¥–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é"""
    # –î–ª—è –†—è–∑–∞–Ω–∏ –ø–æ–ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã
    if "—Ä—è–∑–∞–Ω—å" in name.lower() or "—Ç—é—à–µ–≤—Å–∫–æ–µ" in name.lower():
        print(f"\nüîç –ü–æ–∏—Å–∫ —Å–∫–ª–∞–¥–∞: {name}")
        print("-" * 80)
        print("–†—è–∑–∞–Ω—å (–¢—é—à–µ–≤—Å–∫–æ–µ) - –≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã:")
        print("  - –†—è–∑–∞–Ω—å (–¢—é—à–µ–≤—Å–∫–æ–µ): ID –º–æ–∂–µ—Ç –±—ã—Ç—å 130744, 300571 –∏–ª–∏ –¥—Ä—É–≥–æ–π")
        print("  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –õ–ö WB –∏–ª–∏ —á–µ—Ä–µ–∑ API")
        print("-" * 80)


if __name__ == "__main__":
    print("=" * 80)
    print("–ü–û–ò–°–ö ID –°–ö–õ–ê–î–û–í WILDBERRIES")
    print("=" * 80)

    # –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –≤ –ë–î
    print("\n1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    get_warehouses_from_db()

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫
    get_common_warehouse_ids()

    # –ò—â–µ–º –†—è–∑–∞–Ω—å
    search_warehouse("–†—è–∑–∞–Ω—å –¢—é—à–µ–≤—Å–∫–æ–µ")

    print("\n" + "=" * 80)
    print("–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø:")
    print("=" * 80)
    print("–î–ª—è –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–†—è–∑–∞–Ω—å ‚Üí –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä) –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:")
    print()
    print("python test_redistribution.py \\")
    print("  --phone +79956316615 \\")
    print("  --nm-id 246490100 \\")
    print("  --from-warehouse 300571 \\  # –†—è–∑–∞–Ω—å (–ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ ID)")
    print("  --to-warehouse 130744 \\    # –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä")
    print("  --quantity 1 \\")
    print("  --visible")
    print()
    print("–ï—Å–ª–∏ ID –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π - –±–æ—Ç —Å–∫–∞–∂–µ—Ç –æ–± —ç—Ç–æ–º, –∏ –º–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π.")
    print("=" * 80)
